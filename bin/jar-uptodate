#!/bin/sh
## jar-uptodate -- Find JAR/Java files and sort them by date modified.

echo "Sorted list of archibus-*.jar files (by last modification date) in working directory './dist':"
find ./dist -name "archibus-*.jar" -printf "%T@ %CY-%Cm-%CdT%CH:%CM:%CS %p\n" | sort -n | cut -d " " -f 2- | sed "s/$(date +%F)/  TODAY   /g"

echo ""
echo "Sorted list of archibus-*.jar files (by last modification date) in Git directory './WEB-INF/lib':"
find ./WEB-INF/lib -name "archibus-*.jar" -printf "%T@ %CY-%Cm-%CdT%CH:%CM:%CS %p\n" | sort -n | cut -d " " -f 2- | sed "s/$(date +%F)/  TODAY   /g"
# %Tk: File's last modification time in the format specified by k.
# @: seconds since Jan. 1, 1970, 00:00 GMT, with fractional part.
# %CY-%Cm-%CdT%CH:%CM:%CS: ISO 8601 date and time.
# %p: File's name.

echo ""
REFERENCE_FILE=$(find ./WEB-INF/lib -name "archibus-*.jar" -printf "%T@ %p\n" | sort -n | cut -d " " -f 2- | tail -n 1)
echo "Bottom 5 Java files modified after '$REFERENCE_FILE':"
# Print all Java files newer than reference file.
find . -type f -name "*.java" -newer "$REFERENCE_FILE" -printf "%T@ %CY-%Cm-%CdT%CH:%CM:%CS %p\n" | sort -n | cut -d " " -f 2- | tail -n 5 | sed "s/$(date +%F)/  TODAY   /g"

## jar-uptodate ends here
